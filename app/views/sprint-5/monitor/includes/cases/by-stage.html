<div class="govuk-tabs" data-module="govuk-tabs">
  <ul class="govuk-tabs__list">
    <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
      <a class="govuk-tabs__tab" href="#referral">
        Referral
      </a>
    </li>
    <li class="govuk-tabs__list-item">
      <a class="govuk-tabs__tab" href="#action-plan">
        Action plan
      </a>
    </li>
    <li class="govuk-tabs__list-item">
      <a class="govuk-tabs__tab" href="#intervention-progress">
        Intervention progress
      </a>
    </li>
    <li class="govuk-tabs__list-item">
      <a class="govuk-tabs__tab" href="#completed-interventions">
        Completed interventions
      </a>
    </li>
  </ul>
  <div class="govuk-tabs__panel" id="referral">
    <h2 class="govuk-heading-m">
      Awaiting a caseworker to be assigned
    </h2>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
        {% for referral in referrals %}
        {% set referralIndex = loop.index0 %}
          <tr class="govuk-table__row">
          <td class="govuk-table__cell" rowspan="{{referral.interventions.length}}">
            {{ referral.reference }}
          </td>
          <td class="govuk-table__cell" rowspan="{{referral.interventions.length}}">
            {{ referral.serviceUser.name }}
          </td>

        {% for intervention in referral.interventions %}
          {% if referral.interventions.length > 1 and not loop.first %}
          <tr>
          {% endif%}
            <td class="govuk-table__cell">
              {{ intervention.name | capitalize }}
            </td>
            <td class="govuk-table__cell">
              {{ intervention.providerName }}
            </td>
            <td class="govuk-table__cell">
              {{ intervention.assignedCaseworker }}
            </td>
            <td class="govuk-table__cell">
              <a class="govuk-link" href="cases/{{caseIndex}}/interventions/{{intervention.id}}">View</a>
            </td>

          {% if referral.interventions.length > 1 and not loop.first %}
          </tr>
          {% endif%}

          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <h2 class="govuk-heading-m">
      Awaiting assessment
    </h2>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
        {% for referral in referrals %}
        {% set referralIndex = loop.index0 %}
          <tr class="govuk-table__row">
          <td class="govuk-table__cell" rowspan="{{referral.interventions.length}}">
            {{ referral.reference }}
          </td>
          <td class="govuk-table__cell" rowspan="{{referral.interventions.length}}">
            {{ referral.serviceUser.name }}
          </td>

        {% for intervention in referral.interventions %}
          {% if referral.interventions.length > 1 and not loop.first %}
          <tr>
          {% endif%}
            <td class="govuk-table__cell">
              {{ intervention.name | capitalize }}
            </td>
            <td class="govuk-table__cell">
              {{ intervention.providerName }}
            </td>
            <td class="govuk-table__cell">
              {{ intervention.assignedCaseworker }}
            </td>
            <td class="govuk-table__cell">
              <a class="govuk-link" href="cases/{{caseIndex}}/interventions/{{intervention.id}}">View</a>
            </td>

          {% if referral.interventions.length > 1 and not loop.first %}
          </tr>
          {% endif%}

          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="govuk-tabs__panel" id="action-plan">
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
      </tbody>
    </table>
  </div>
  <div class="govuk-tabs__panel" id="intervention-progress">
    <h2 class="govuk-heading-m">
      Interventions in progress
    </h2>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
      </tbody>
    </table>

    <h2 class="govuk-heading-m">
      Session assessment overdue
    </h2>
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
      </tbody>
    </table>
  </div>
  <div class="govuk-tabs__panel" id="completed-interventions">
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header" aria-sort="ascending">Referral</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Service User</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Intervention category</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Provider</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Caseworker</th>
          <th scope="col" class="govuk-table__header" aria-sort="none">Action</th>
        </tr>
      </thead>

      <tbody class="govuk-table__body">
      </tbody>
    </table>
  </div>
</div>